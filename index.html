<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Man Sango at 6 - Live Concert at Echo Lounge Kisii Town</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://js.paystack.co/v1/inline.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
    <style>
        :root {
            --primary: #1a4b8c;
            --primary-light: #2a6fd6;
            --primary-dark: #0d2b5a;
            --accent: #ff6b35;
            --black: #0a0a0a;
            --dark: #1e1e1e;
            --gray: #3a3a3a;
            --light-gray: #e0e0e0;
            --white: #ffffff;
            --success: #10b981;
            --error: #ef4444;
            --warning: #f59e0b;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--white);
            color: var(--dark);
            line-height: 1.6;
            overflow-x: hidden;
            display: flex;
            min-height: 100vh;
        }

        /* Side Navigation */
        .side-nav {
            width: 250px;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: var(--white);
            padding: 30px 0;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            z-index: 1000;
            box-shadow: 5px 0 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .logo {
            text-align: center;
            padding: 0 20px 30px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 30px;
        }

        .logo img {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid var(--accent);
            margin-bottom: 15px;
        }

        .logo h1 {
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--white);
        }

        .logo p {
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.7);
            margin-top: 5px;
        }

        .nav-links {
            display: flex;
            flex-direction: column;
            gap: 5px;
            padding: 0 15px;
        }

        .nav-links a {
            color: var(--white);
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s ease;
            padding: 15px 20px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .nav-links a i {
            width: 20px;
            text-align: center;
            font-size: 1.1rem;
        }

        .nav-links a:hover {
            background: rgba(255, 255, 255, 0.1);
            color: var(--accent);
            transform: translateX(5px);
        }

        .nav-links a.active {
            background: rgba(255, 255, 255, 0.15);
            color: var(--accent);
            border-left: 4px solid var(--accent);
        }

        .social-sidebar {
            padding: 30px 20px 0;
            margin-top: 30px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .social-sidebar h3 {
            font-size: 1rem;
            margin-bottom: 15px;
            color: rgba(255, 255, 255, 0.8);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .social-links-side {
            display: flex;
            gap: 10px;
            justify-content: center;
        }

        .social-link-side {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            color: var(--white);
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .social-link-side:hover {
            background: var(--accent);
            transform: translateY(-3px);
        }

        /* Main Content */
        .main-content {
            flex: 1;
            margin-left: 250px;
            transition: all 0.3s ease;
        }

        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Page Sections */
        .page {
            display: none;
            padding: 40px 0;
            min-height: 100vh;
        }

        .page.active {
            display: block;
        }

        /* Mobile Menu Button */
        .mobile-menu-btn {
            display: none;
            position: fixed;
            top: 20px;
            left: 20px;
            background: var(--primary);
            color: var(--white);
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 1.5rem;
            cursor: pointer;
            z-index: 1100;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        /* Hero Section */
        .hero {
            position: relative;
            height: 100vh;
            min-height: 700px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(rgba(10, 10, 10, 0.7), rgba(26, 75, 140, 0.8)), url('https://kzrrqbkirnemawtgcwpt.supabase.co/storage/v1/object/public/Pictures/WhatsApp%20Image%202025-11-10%20at%207.18.25%20PM.jpeg');
            background-size: cover;
            background-position: center;
            text-align: center;
            padding: 20px;
            color: var(--white);
        }

        .hero-content {
            max-width: 800px;
            z-index: 2;
        }

        .hero h1 {
            font-size: 2.5rem;
            font-weight: 800;
            margin-bottom: 1rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--white);
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
        }

        .hero .date {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--accent);
        }

        .hero .venue {
            font-size: 1.2rem;
            margin-bottom: 2rem;
            color: var(--white);
        }

        .countdown {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 2rem 0;
        }

        .countdown-item {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid var(--accent);
            border-radius: 10px;
            padding: 15px 10px;
            min-width: 80px;
            backdrop-filter: blur(10px);
        }

        .countdown-number {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--accent);
        }

        .countdown-label {
            font-size: 0.8rem;
            text-transform: uppercase;
            color: var(--white);
        }

        .btn {
            display: inline-block;
            padding: 15px 30px;
            background: linear-gradient(135deg, var(--accent), #ff8c5a);
            color: var(--white);
            border: none;
            border-radius: 50px;
            font-weight: 700;
            font-size: 1rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(255, 107, 53, 0.3);
            text-decoration: none;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(255, 107, 53, 0.5);
        }

        .btn-secondary {
            background: transparent;
            color: var(--accent);
            border: 2px solid var(--accent);
        }

        .btn-secondary:hover {
            background: rgba(255, 107, 53, 0.1);
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            box-shadow: 0 4px 15px rgba(26, 75, 140, 0.3);
        }

        .btn-primary:hover {
            box-shadow: 0 6px 20px rgba(26, 75, 140, 0.5);
        }

        /* Sections */
        .section-title {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 2rem;
            text-align: center;
            color: var(--primary);
            position: relative;
        }

        .section-title:after {
            content: '';
            display: block;
            width: 80px;
            height: 4px;
            background: linear-gradient(to right, var(--primary), var(--accent));
            margin: 10px auto;
            border-radius: 2px;
        }

        /* About Section */
        .about {
            background-color: var(--white);
        }

        .about-content {
            max-width: 800px;
            margin: 0 auto;
            text-align: center;
            font-size: 1.1rem;
        }

        .artist-image {
            width: 300px;
            height: 300px;
            border-radius: 50%;
            object-fit: cover;
            margin: 30px auto;
            border: 5px solid var(--primary);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        /* Tickets Section */
        .tickets {
            background-color: var(--light-gray);
        }

        .ticket-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-top: 40px;
        }

        .ticket-card {
            background: var(--white);
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            transition: all 0.3s ease;
            border: 1px solid var(--light-gray);
            position: relative;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }

        .ticket-card:before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background: linear-gradient(to right, var(--primary), var(--accent));
        }

        .ticket-card:hover {
            transform: translateY(-10px);
            border-color: var(--primary);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .ticket-card.vip {
            border-color: var(--primary);
        }

        .ticket-card.vvip {
            border: 2px solid var(--primary);
            transform: scale(1.05);
        }

        .ticket-type {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 10px;
            color: var(--primary);
        }

        .ticket-price {
            font-size: 2.5rem;
            font-weight: 800;
            margin-bottom: 20px;
            color: var(--dark);
        }

        .ticket-features {
            list-style: none;
            margin-bottom: 25px;
            text-align: left;
        }

        .ticket-features li {
            padding: 8px 0;
            border-bottom: 1px solid var(--light-gray);
        }

        .ticket-features li:last-child {
            border-bottom: none;
        }

        .ticket-features li i {
            color: var(--primary);
            margin-right: 10px;
        }

        /* Merchandise Section */
        .merchandise {
            background-color: var(--white);
        }

        .merch-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 30px;
            margin-top: 40px;
        }

        .merch-card {
            background: var(--white);
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
            border: 1px solid var(--light-gray);
        }

        .merch-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .merch-image {
            height: 250px;
            background-color: var(--light-gray);
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        .merch-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
        }

        .merch-card:hover .merch-image img {
            transform: scale(1.1);
        }

        .merch-details {
            padding: 20px;
        }

        .merch-title {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 10px;
            color: var(--primary);
        }

        .merch-price {
            font-size: 1.5rem;
            font-weight: 800;
            margin-bottom: 15px;
            color: var(--dark);
        }

        .merch-features {
            list-style: none;
            margin-bottom: 20px;
        }

        .merch-features li {
            padding: 5px 0;
            color: var(--gray);
        }

        .merch-features li i {
            color: var(--primary);
            margin-right: 10px;
        }

        /* Color Selection */
        .color-options {
            display: flex;
            gap: 10px;
            margin: 15px 0;
            flex-wrap: wrap;
        }

        .color-option {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .color-option:hover {
            transform: scale(1.1);
        }

        .color-option.selected {
            border-color: var(--primary);
            transform: scale(1.1);
        }

        /* Gallery Section */
        .gallery {
            background-color: var(--light-gray);
        }

        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 40px;
        }

        .gallery-item {
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .gallery-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        }

        .gallery-item img {
            width: 100%;
            height: 200px;
            object-fit: cover;
            display: block;
        }

        /* Booking Form */
        .booking-form {
            background: var(--white);
            border-radius: 15px;
            padding: 30px;
            margin-top: 40px;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.05);
            border: 1px solid var(--light-gray);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--primary);
        }

        .form-control {
            width: 100%;
            padding: 15px;
            background: var(--white);
            border: 1px solid var(--light-gray);
            border-radius: 10px;
            color: var(--dark);
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(26, 75, 140, 0.2);
        }

        .form-row {
            display: flex;
            gap: 15px;
        }

        .form-row .form-group {
            flex: 1;
        }

        .total-price {
            text-align: center;
            font-size: 1.5rem;
            font-weight: 700;
            margin: 25px 0;
            color: var(--primary);
        }

        /* Payment Options */
        .payment-options {
            margin-top: 30px;
        }

        .payment-tab {
            display: none;
        }

        .payment-tab.active {
            display: block;
        }

        .tab-buttons {
            display: flex;
            margin-bottom: 20px;
            border-radius: 10px;
            overflow: hidden;
            background: var(--light-gray);
        }

        .tab-button {
            flex: 1;
            padding: 15px;
            text-align: center;
            background: transparent;
            border: none;
            color: var(--dark);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .tab-button.active {
            background: var(--primary);
            color: var(--white);
        }

        .payment-instructions {
            background: var(--light-gray);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .payment-instructions ol {
            padding-left: 20px;
            margin-bottom: 15px;
        }

        .payment-instructions li {
            margin-bottom: 10px;
        }

        .till-number {
            display: inline-block;
            background: var(--white);
            padding: 10px 15px;
            border-radius: 8px;
            font-weight: 700;
            color: var(--primary);
            margin: 10px 0;
        }

        .status-message {
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
            font-weight: 600;
        }

        .status-processing {
            background: rgba(245, 158, 11, 0.2);
            border: 1px solid var(--warning);
            color: var(--warning);
        }

        .status-success {
            background: rgba(16, 185, 129, 0.2);
            border: 1px solid var(--success);
            color: var(--success);
        }

        .status-error {
            background: rgba(239, 68, 68, 0.2);
            border: 1px solid var(--error);
            color: var(--error);
        }

        /* Ticket Retrieval */
        .ticket-retrieval {
            background: var(--white);
            border-radius: 15px;
            padding: 30px;
            margin-top: 40px;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.05);
            border: 1px solid var(--light-gray);
        }

        /* Donation Section */
        .donation {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: var(--white);
        }

        .donation .section-title {
            color: var(--white);
        }

        .donation .section-title:after {
            background: linear-gradient(to right, var(--accent), #ff8c5a);
        }

        .donation-form {
            max-width: 600px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.1);
            padding: 30px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }

        .donation-options {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 20px 0;
        }

        .donation-option {
            flex: 1;
            min-width: 100px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .donation-option:hover, .donation-option.active {
            background: var(--accent);
            border-color: var(--accent);
        }

        /* Contact Section */
        .contact {
            background-color: var(--light-gray);
        }

        .contact-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
            margin-top: 40px;
        }

        .contact-card {
            background: var(--white);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }

        .contact-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }

        .contact-icon {
            font-size: 2.5rem;
            color: var(--primary);
            margin-bottom: 15px;
        }

        .contact-card h3 {
            font-size: 1.3rem;
            margin-bottom: 15px;
            color: var(--primary);
        }

        .social-links {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
        }

        .social-link {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 50px;
            height: 50px;
            background: var(--primary);
            border-radius: 50%;
            color: var(--white);
            font-size: 1.2rem;
            transition: all 0.3s ease;
        }

        .social-link:hover {
            background: var(--accent);
            transform: translateY(-3px);
        }

        /* Footer */
        footer {
            background: var(--dark);
            color: var(--white);
            padding: 40px 0;
            text-align: center;
        }

        .footer-content {
            max-width: 800px;
            margin: 0 auto;
        }

        .credits {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid var(--gray);
            font-size: 0.9rem;
            color: var(--light-gray);
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: var(--white);
            border-radius: 15px;
            padding: 30px;
            max-width: 500px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .modal-close {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            color: var(--dark);
            font-size: 1.5rem;
            cursor: pointer;
        }

        /* Mobile Quick Actions */
        .mobile-quick-actions {
            display: none;
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--white);
            border-radius: 50px;
            padding: 10px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.15);
            z-index: 1000;
            gap: 10px;
        }

        .mobile-quick-actions .btn {
            padding: 10px 20px;
            font-size: 0.8rem;
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .side-nav {
                width: 220px;
            }
            
            .main-content {
                margin-left: 220px;
            }
        }

        @media (max-width: 768px) {
            .side-nav {
                transform: translateX(-100%);
                width: 280px;
            }
            
            .side-nav.active {
                transform: translateX(0);
            }
            
            .main-content {
                margin-left: 0;
            }
            
            .mobile-menu-btn {
                display: flex;
                align-items: center;
                justify-content: center;
            }
            
            .mobile-quick-actions {
                display: flex;
            }
            
            .hero h1 {
                font-size: 2rem;
            }
            
            .countdown-item {
                min-width: 70px;
                padding: 10px 5px;
            }
            
            .countdown-number {
                font-size: 1.5rem;
            }
            
            .ticket-card.vvip {
                transform: none;
            }
            
            .form-row {
                flex-direction: column;
                gap: 0;
            }
            
            .section-title {
                font-size: 1.7rem;
            }
            
            .ticket-options, .merch-grid, .contact-info, .gallery-grid {
                grid-template-columns: 1fr;
            }
            
            .artist-image {
                width: 250px;
                height: 250px;
            }
        }

        @media (max-width: 480px) {
            .hero h1 {
                font-size: 1.7rem;
            }
            
            .hero .date {
                font-size: 1.2rem;
            }
            
            .hero .venue {
                font-size: 1rem;
            }
            
            .countdown {
                gap: 10px;
            }
            
            .countdown-item {
                min-width: 60px;
                padding: 8px 5px;
            }
            
            .countdown-number {
                font-size: 1.3rem;
            }
            
            .countdown-label {
                font-size: 0.7rem;
            }
            
            .btn {
                padding: 12px 25px;
                font-size: 0.9rem;
            }
            
            .section-title {
                font-size: 1.5rem;
            }
            
            .mobile-quick-actions {
                flex-direction: column;
                width: 90%;
                border-radius: 15px;
            }
            
            .artist-image {
                width: 200px;
                height: 200px;
            }
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in {
            animation: fadeIn 0.8s ease forwards;
        }

        .delay-1 { animation-delay: 0.2s; opacity: 0; }
        .delay-2 { animation-delay: 0.4s; opacity: 0; }
        .delay-3 { animation-delay: 0.6s; opacity: 0; }
        .delay-4 { animation-delay: 0.8s; opacity: 0; }
    </style>
</head>
<body>
    <!-- Mobile Menu Button -->
    <button class="mobile-menu-btn">
        <i class="fas fa-bars"></i>
    </button>

    <!-- Side Navigation -->
    <nav class="side-nav">
        <div class="logo">
            <!-- Updated business logo -->
            <img src="https://kzrrqbkirnemawtgcwpt.supabase.co/storage/v1/object/public/Pictures/WhatsApp%20Image%202025-11-10%20at%207.42.31%20PM.jpeg" alt="Man Sango">
            <h1>MAN SANGO</h1>
            <p>Live Concert Experience</p>
        </div>
        
        <div class="nav-links">
            <a href="#home" class="nav-link active" data-page="home">
                <i class="fas fa-home"></i>
                <span>Home</span>
            </a>
            <a href="#about" class="nav-link" data-page="about">
                <i class="fas fa-info-circle"></i>
                <span>About</span>
            </a>
            <a href="#tickets" class="nav-link" data-page="tickets">
                <i class="fas fa-ticket-alt"></i>
                <span>Tickets</span>
            </a>
            <a href="#merchandise" class="nav-link" data-page="merchandise">
                <i class="fas fa-tshirt"></i>
                <span>Merchandise</span>
            </a>
            <a href="#gallery" class="nav-link" data-page="gallery">
                <i class="fas fa-images"></i>
                <span>Gallery</span>
            </a>
            <a href="#donation" class="nav-link" data-page="donation">
                <i class="fas fa-heart"></i>
                <span>Donate</span>
            </a>
            <a href="#contact" class="nav-link" data-page="contact">
                <i class="fas fa-envelope"></i>
                <span>Contact</span>
            </a>
        </div>
        
        <div class="social-sidebar">
            <h3>Follow Us</h3>
            <div class="social-links-side">
                <a href="https://www.facebook.com/ManSangoOfficial" class="social-link-side" target="_blank">
                    <i class="fab fa-facebook-f"></i>
                </a>
                <a href="https://x.com/MRikindi" class="social-link-side" target="_blank">
                    <i class="fab fa-twitter"></i>
                </a>
                <a href="https://www.instagram.com/man_sango_official/" class="social-link-side" target="_blank">
                    <i class="fab fa-instagram"></i>
                </a>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="main-content">
        <!-- Home Page -->
        <section id="home" class="page active">
            <div class="hero">
                <div class="container">
                    <div class="hero-content fade-in">
                        <h1>Man Sango at 6 Live Concert at Echo Lounge Kisii Town</h1>
                        <p class="date">Friday, 12 December 2025 â€” 4:00 PM</p>
                        <p class="venue">Echo Lounge, MKO Plaza, Daraja Mbili, Kisii</p>
                        
                        <div class="countdown">
                            <div class="countdown-item">
                                <div class="countdown-number" id="days">00</div>
                                <div class="countdown-label">Days</div>
                            </div>
                            <div class="countdown-item">
                                <div class="countdown-number" id="hours">00</div>
                                <div class="countdown-label">Hours</div>
                            </div>
                            <div class="countdown-item">
                                <div class="countdown-number" id="minutes">00</div>
                                <div class="countdown-label">Minutes</div>
                            </div>
                            <div class="countdown-item">
                                <div class="countdown-number" id="seconds">00</div>
                                <div class="countdown-label">Seconds</div>
                            </div>
                        </div>
                        
                        <a href="#tickets" class="btn nav-link" data-page="tickets">Book Tickets Now</a>
                    </div>
                </div>
            </div>
        </section>

        <!-- About Page -->
        <section id="about" class="page">
            <div class="container">
                <h2 class="section-title fade-in">About The Event</h2>
                <div class="about-content fade-in delay-1">
                    <!-- Updated artist image -->
                    <img src="https://kzrrqbkirnemawtgcwpt.supabase.co/storage/v1/object/public/Pictures/WhatsApp%20Image%202025-11-10%20at%207.42.31%20PM.jpeg" alt="Man Sango" class="artist-image">
                    <p>Get ready for an unforgettable night of live music with Man Sango at Echo Lounge Kisii! This highly anticipated concert will feature electrifying performances of his biggest hits along with special surprises.</p>
                    <p>Doors open at 4:00 PM, with the show starting promptly. Come early to secure the best spots and enjoy the pre-show atmosphere with drinks and music.</p>
                    <p>This is a premium entertainment experience you won't want to miss. Book your tickets now to avoid disappointment!</p>
                </div>
            </div>
        </section>

        <!-- Tickets Page -->
        <section id="tickets" class="page">
            <div class="container">
                <h2 class="section-title fade-in">Ticket Options</h2>
                
                <div class="ticket-options">
                    <div class="ticket-card fade-in">
                        <h3 class="ticket-type">Regular</h3>
                        <div class="ticket-price">KSH 500</div>
                        <ul class="ticket-features">
                            <li><i class="fas fa-check"></i> General Admission</li>
                            <li><i class="fas fa-check"></i> Standing Area Access</li>
                            <li><i class="fas fa-check"></i> Basic Bar Service</li>
                        </ul>
                        <button class="btn btn-primary select-ticket" data-type="Regular" data-price="500">Select</button>
                    </div>
                    
                    <div class="ticket-card vip fade-in delay-1">
                        <h3 class="ticket-type">VIP</h3>
                        <div class="ticket-price">KSH 1000</div>
                        <ul class="ticket-features">
                            <li><i class="fas fa-check"></i> Priority Entry</li>
                            <li><i class="fas fa-check"></i> Reserved Seating</li>
                            <li><i class="fas fa-check"></i> Premium Bar Service</li>
                            <li><i class="fas fa-check"></i> VIP Lounge Access</li>
                        </ul>
                        <button class="btn btn-primary select-ticket" data-type="VIP" data-price="1000">Select</button>
                    </div>
                    
                    <div class="ticket-card vvip fade-in delay-2">
                        <h3 class="ticket-type">VVIP</h3>
                        <div class="ticket-price">KSH 2000</div>
                        <ul class="ticket-features">
                            <li><i class="fas fa-check"></i> Fast Track Entry</li>
                            <li><i class="fas fa-check"></i> Premium Reserved Seating</li>
                            <li><i class="fas fa-check"></i> Complimentary Drink</li>
                            <li><i class="fas fa-check"></i> Exclusive VVIP Area</li>
                            <li><i class="fas fa-check"></i> Meet & Greet Opportunity</li>
                        </ul>
                        <button class="btn btn-primary select-ticket" data-type="VVIP" data-price="2000">Select</button>
                    </div>
                </div>
                
                <!-- Booking Form -->
                <div class="booking-form fade-in delay-3" id="bookingForm" style="display: none;">
                    <h3 class="section-title">Book Your Tickets</h3>
                    
                    <form id="ticketForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="name">Full Name</label>
                                <input type="text" id="name" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label for="phone">M-Pesa Phone Number</label>
                                <input type="tel" id="phone" class="form-control" placeholder="2547XXXXXXXX or 0712345678" required>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="email">Email Address</label>
                            <input type="email" id="email" class="form-control" placeholder="Enter your email address" required>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="ticketType">Ticket Type</label>
                                <input type="text" id="ticketType" class="form-control" readonly>
                            </div>
                            <div class="form-group">
                                <label for="quantity">Quantity</label>
                                <select id="quantity" class="form-control">
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="total-price">
                            Total: KSH <span id="totalAmount">0</span>
                        </div>
                        
                        <button type="button" class="btn btn-primary" id="proceedToPayment">Proceed to Payment</button>
                    </form>
                </div>
                
                <!-- Payment Options -->
                <div class="payment-options fade-in delay-4" id="paymentOptions" style="display: none;">
                    <h3 class="section-title">Payment Options</h3>
                    
                    <div class="payment-instructions">
                        <h4>M-Pesa Payment Instructions:</h4>
                        <ol>
                            <li>Click "Pay Now with M-Pesa" below</li>
                            <li>A Paystack popup will appear</li>
                            <li>Select "M-Pesa" as your payment method</li>
                            <li>Enter your M-Pesa PIN when prompted</li>
                            <li>Wait for payment confirmation</li>
                        </ol>
                        <p>You will receive an M-Pesa prompt on your phone to complete the payment.</p>
                    </div>
                    
                    <button class="btn btn-primary" id="paystackPayment">Pay Now with M-Pesa</button>
                    
                    <div id="paystackStatus" style="display: none;">
                        <!-- Status messages will appear here -->
                    </div>
                </div>
                
                <!-- Ticket Retrieval -->
                <div class="ticket-retrieval fade-in" id="ticketRetrieval">
                    <h3 class="section-title">Already Paid? Retrieve Your Ticket</h3>
                    
                    <div class="form-group">
                        <label for="retrieveBookingRef">Booking Reference</label>
                        <input type="text" id="retrieveBookingRef" class="form-control" placeholder="e.g., MS-20251212-ABCDE">
                    </div>
                    
                    <div class="form-group">
                        <label for="retrievePhone">Phone Number</label>
                        <input type="tel" id="retrievePhone" class="form-control" placeholder="2547XXXXXXXX or 0712345678">
                    </div>
                    
                    <button class="btn btn-primary" id="retrieveTicket">Retrieve Ticket</button>
                    
                    <div id="retrieveStatus" style="display: none;">
                        <!-- Status messages will appear here -->
                    </div>
                </div>
            </div>
        </section>

        <!-- Merchandise Page -->
        <section id="merchandise" class="page">
            <div class="container">
                <h2 class="section-title fade-in">Official Merchandise</h2>
                
                <div class="merch-grid">
                    <div class="merch-card fade-in">
                        <div class="merch-image">
                            <!-- Updated T-shirt images -->
                            <img src="https://kzrrqbkirnemawtgcwpt.supabase.co/storage/v1/object/public/Pictures/IMG-20251108-WA0007.jpg" alt="Man Sango T-Shirt">
                        </div>
                        <div class="merch-details">
                            <h3 class="merch-title">Man Sango T-Shirt</h3>
                            <div class="merch-price">KSH 1500</div>
                            <ul class="merch-features">
                                <li><i class="fas fa-check"></i> Premium quality cotton</li>
                                <li><i class="fas fa-check"></i> Official event design</li>
                                <li><i class="fas fa-check"></i> Available in multiple sizes</li>
                            </ul>
                            <button class="btn btn-primary buy-merch" data-item="T-Shirt" data-price="1500">Buy Now</button>
                        </div>
                    </div>
                    
                    <div class="merch-card fade-in delay-1">
                        <div class="merch-image">
                            <!-- Updated Hoodie images -->
                            <img src="https://kzrrqbkirnemawtgcwpt.supabase.co/storage/v1/object/public/Pictures/IMG-20251108-WA0006.jpg" alt="Man Sango Hoodie">
                        </div>
                        <div class="merch-details">
                            <h3 class="merch-title">Man Sango Hoodie</h3>
                            <div class="merch-price">KSH 3000</div>
                            <ul class="merch-features">
                                <li><i class="fas fa-check"></i> Premium fleece material</li>
                                <li><i class="fas fa-check"></i> Official event design</li>
                                <li><i class="fas fa-check"></i> Available in multiple sizes</li>
                                <li><i class="fas fa-check"></i> Front pocket</li>
                            </ul>
                            <button class="btn btn-primary buy-merch" data-item="Hoodie" data-price="3000">Buy Now</button>
                        </div>
                    </div>
                </div>
                
                <!-- Merchandise Purchase Form -->
                <div class="booking-form fade-in delay-2" id="merchForm" style="display: none;">
                    <h3 class="section-title">Purchase Merchandise</h3>
                    
                    <form id="merchPurchaseForm">
                        <div class="form-group">
                            <label for="merchItem">Item</label>
                            <input type="text" id="merchItem" class="form-control" readonly>
                        </div>
                        
                        <div class="form-group">
                            <label>Select Color</label>
                            <div class="color-options" id="colorOptions">
                                <!-- Color options will be dynamically added here -->
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="merchSize">Size</label>
                                <select id="merchSize" class="form-control">
                                    <option value="S">Small</option>
                                    <option value="M">Medium</option>
                                    <option value="L">Large</option>
                                    <option value="XL">X-Large</option>
                                    <option value="XXL">XX-Large</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="merchQuantity">Quantity</label>
                                <select id="merchQuantity" class="form-control">
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="customerName">Full Name</label>
                                <input type="text" id="customerName" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label for="customerPhone">M-Pesa Phone Number</label>
                                <input type="tel" id="customerPhone" class="form-control" placeholder="2547XXXXXXXX or 0712345678" required>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="customerEmail">Email Address</label>
                            <input type="email" id="customerEmail" class="form-control" placeholder="Enter your email address" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="deliveryOption">Delivery Option</label>
                            <select id="deliveryOption" class="form-control">
                                <option value="event">Collect at Event (Free)</option>
                                <option value="delivery">Home Delivery (KSH 200)</option>
                            </select>
                        </div>
                        
                        <div class="form-group" id="deliveryAddressGroup" style="display: none;">
                            <label for="deliveryAddress">Delivery Address</label>
                            <textarea id="deliveryAddress" class="form-control" rows="3" placeholder="Enter your full delivery address"></textarea>
                        </div>
                        
                        <div class="total-price">
                            Total: KSH <span id="merchTotalAmount">0</span>
                        </div>
                        
                        <button type="button" class="btn btn-primary" id="proceedToMerchPayment">Proceed to Payment</button>
                    </form>
                </div>
                
                <!-- Merchandise Payment Options -->
                <div class="payment-options fade-in delay-3" id="merchPaymentOptions" style="display: none;">
                    <h3 class="section-title">Payment Options</h3>
                    
                    <div class="payment-instructions">
                        <h4>M-Pesa Payment Instructions:</h4>
                        <ol>
                            <li>Click "Pay Now with M-Pesa" below</li>
                            <li>A Paystack popup will appear</li>
                            <li>Select "M-Pesa" as your payment method</li>
                            <li>Enter your M-Pesa PIN when prompted</li>
                            <li>Wait for payment confirmation</li>
                        </ol>
                        <p>You will receive an M-Pesa prompt on your phone to complete the payment.</p>
                    </div>
                    
                    <button class="btn btn-primary" id="merchPaystackPayment">Pay Now with M-Pesa</button>
                    
                    <div id="merchPaystackStatus" style="display: none;">
                        <!-- Status messages will appear here -->
                    </div>
                </div>
            </div>
        </section>

        <!-- Gallery Page -->
        <section id="gallery" class="page">
            <div class="container">
                <h2 class="section-title fade-in">Event Gallery</h2>
                <p style="text-align: center; margin-bottom: 30px;">Take a look at some moments from previous events and promotional materials</p>
                
                <div class="gallery-grid">
                    <!-- Updated gallery images with all the provided URLs -->
                    <div class="gallery-item fade-in">
                        <img src="https://kzrrqbkirnemawtgcwpt.supabase.co/storage/v1/object/public/Pictures/IMG-20251108-WA0005.jpg" alt="Concert Performance">
                    </div>
                    <div class="gallery-item fade-in delay-1">
                        <img src="https://kzrrqbkirnemawtgcwpt.supabase.co/storage/v1/object/public/Pictures/WhatsApp%20Image%202025-11-10%20at%207.18.25%20PM.jpeg" alt="Crowd at Event">
                    </div>
                    <div class="gallery-item fade-in delay-2">
                        <img src="https://kzrrqbkirnemawtgcwpt.supabase.co/storage/v1/object/public/Pictures/WhatsApp%20Image%202025-11-10%20at%207.18.24%20PM.jpeg" alt="Stage Performance">
                    </div>
                    <div class="gallery-item fade-in delay-3">
                        <img src="https://kzrrqbkirnemawtgcwpt.supabase.co/storage/v1/object/public/Pictures/WhatsApp%20Image%202025-11-10%20at%207.18.22%20PM.jpeg" alt="Artist Close-up">
                    </div>
                    <div class="gallery-item fade-in delay-1">
                        <img src="https://kzrrqbkirnemawtgcwpt.supabase.co/storage/v1/object/public/Pictures/WhatsApp%20Image%202025-11-10%20at%207.18.21%20PM.jpeg" alt="Event Venue">
                    </div>
                    <div class="gallery-item fade-in delay-2">
                        <img src="https://kzrrqbkirnemawtgcwpt.supabase.co/storage/v1/object/public/Pictures/WhatsApp%20Image%202025-11-10%20at%207.18.20%20PM.jpeg" alt="Artist Performance">
                    </div>
                    <div class="gallery-item fade-in delay-3">
                        <img src="https://kzrrqbkirnemawtgcwpt.supabase.co/storage/v1/object/public/Pictures/WhatsApp%20Image%202025-11-10%20at%207.18.15%20PM.jpeg" alt="Concert Performance">
                    </div>
                    <div class="gallery-item fade-in delay-1">
                        <img src="https://kzrrqbkirnemawtgcwpt.supabase.co/storage/v1/object/public/Pictures/WhatsApp%20Image%202025-11-10%20at%207.18.15%20PM%20(1).jpeg" alt="Crowd at Event">
                    </div>
                    <div class="gallery-item fade-in delay-2">
                        <img src="https://kzrrqbkirnemawtgcwpt.supabase.co/storage/v1/object/public/Pictures/WhatsApp%20Image%202025-11-10%20at%207.18.14%20PM.jpeg" alt="Stage Performance">
                    </div>
                    <div class="gallery-item fade-in delay-3">
                        <img src="https://kzrrqbkirnemawtgcwpt.supabase.co/storage/v1/object/public/Pictures/WhatsApp%20Image%202025-11-10%20at%207.18.11%20PM.jpeg" alt="Artist Close-up">
                    </div>
                    <div class="gallery-item fade-in delay-1">
                        <img src="https://kzrrqbkirnemawtgcwpt.supabase.co/storage/v1/object/public/Pictures/WhatsApp%20Image%202025-11-10%20at%207.18.10%20PM.jpeg" alt="Event Venue">
                    </div>
                    <div class="gallery-item fade-in delay-2">
                        <img src="https://kzrrqbkirnemawtgcwpt.supabase.co/storage/v1/object/public/Pictures/WhatsApp%20Image%202025-11-10%20at%207.46.07%20PM.jpeg" alt="Artist Performance">
                    </div>
                </div>
            </div>
        </section>

        <!-- Donation Page -->
        <section id="donation" class="page">
            <div class="container">
                <h2 class="section-title fade-in">Support Man Sango</h2>
                
                <div class="donation-form fade-in delay-1">
                    <p style="text-align: center; margin-bottom: 20px;">Your support helps create more amazing music and events. Every donation makes a difference!</p>
                    
                    <div class="form-group">
                        <label for="donorName">Your Name</label>
                        <input type="text" id="donorName" class="form-control" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="donorPhone">M-Pesa Phone Number</label>
                        <input type="tel" id="donorPhone" class="form-control" placeholder="2547XXXXXXXX or 0712345678" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="donorEmail">Email Address</label>
                        <input type="email" id="donorEmail" class="form-control" placeholder="Enter your email address" required>
                    </div>
                    
                    <div class="form-group">
                        <label>Donation Amount</label>
                        <div class="donation-options">
                            <div class="donation-option" data-amount="100">KSH 100</div>
                            <div class="donation-option" data-amount="500">KSH 500</div>
                            <div class="donation-option" data-amount="1000">KSH 1000</div>
                            <div class="donation-option" data-amount="2000">KSH 2000</div>
                            <div class="donation-option" data-amount="5000">KSH 5000</div>
                        </div>
                        <div class="form-group" style="margin-top: 15px;">
                            <input type="number" id="customAmount" class="form-control" placeholder="Or enter custom amount">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="donorMessage">Message (Optional)</label>
                        <textarea id="donorMessage" class="form-control" rows="3" placeholder="Share an encouraging message"></textarea>
                    </div>
                    
                    <button class="btn" id="donateNow">Donate Now</button>
                    
                    <div id="donationStatus" style="display: none; margin-top: 20px;">
                        <!-- Status messages will appear here -->
                    </div>
                </div>
            </div>
        </section>

        <!-- Contact Page -->
        <section id="contact" class="page">
            <div class="container">
                <h2 class="section-title fade-in">Contact & Socials</h2>
                
                <div class="contact-info">
                    <div class="contact-card fade-in">
                        <div class="contact-icon">
                            <i class="fas fa-phone-alt"></i>
                        </div>
                        <h3>Phone / WhatsApp</h3>
                        <p>0748840501</p>
                        <a href="https://wa.me/254748840501" class="btn btn-secondary" target="_blank">Chat on WhatsApp</a>
                    </div>
                    
                    <div class="contact-card fade-in delay-1">
                        <div class="contact-icon">
                            <i class="fas fa-envelope"></i>
                        </div>
                        <h3>Email</h3>
                        <p>mansangoentertainment@gmail.com</p>
                        <a href="mailto:mansangoentertainment@gmail.com" class="btn btn-secondary">Send Email</a>
                    </div>
                    
                    <div class="contact-card fade-in delay-2">
                        <div class="contact-icon">
                            <i class="fas fa-map-marker-alt"></i>
                        </div>
                        <h3>Venue</h3>
                        <p>Echo Lounge, MKO Plaza, Daraja Mbili, Kisii</p>
                        <a href="https://maps.app.goo.gl/gp9uKeJqdsFJjUWh7" class="btn btn-secondary" target="_blank">View on Map</a>
                    </div>
                </div>
                
                <div class="social-links fade-in delay-3">
                    <a href="https://www.facebook.com/ManSangoOfficial" class="social-link" target="_blank">
                        <i class="fab fa-facebook-f"></i>
                    </a>
                    <a href="https://x.com/MRikindi" class="social-link" target="_blank">
                        <i class="fab fa-twitter"></i>
                    </a>
                    <a href="https://www.instagram.com/man_sango_official/" class="social-link" target="_blank">
                        <i class="fab fa-instagram"></i>
                    </a>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer>
            <div class="container">
                <div class="footer-content">
                    <p>Man Sango at 6 Live Concert at Echo Lounge Kisii Town</p>
                    <div class="credits">
                        <p>Website developed by Felix Nyabuto (0716625790)</p>
                        <p>Â© 2025 Fresh Music Entertainment. All rights reserved.</p>
                    </div>
                </div>
            </div>
        </footer>

        <!-- Mobile Quick Actions -->
        <div class="mobile-quick-actions">
            <a href="#tickets" class="btn btn-primary nav-link" data-page="tickets">Book Tickets</a>
            <a href="#merchandise" class="btn btn-secondary nav-link" data-page="merchandise">Buy Merch</a>
            <a href="https://wa.me/254748840501" class="btn btn-secondary" target="_blank">
                <i class="fab fa-whatsapp"></i>
            </a>
        </div>

        <!-- Success Modal -->
        <div class="modal" id="successModal">
            <div class="modal-content">
                <button class="modal-close" id="closeModal">&times;</button>
                <div style="text-align: center; padding: 20px;">
                    <div style="font-size: 4rem; color: var(--success); margin-bottom: 20px;">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <h2 style="color: var(--primary); margin-bottom: 15px;" id="modalTitle">Payment Successful!</h2>
                    <p id="modalMessage">Your payment has been successfully processed.</p>
                    <p>Your order reference: <strong id="orderRefDisplay">MS-ABCDE12345</strong></p>
                    <p>Your PDF ticket has been sent to your email and is downloading now.</p>
                    <button class="btn btn-primary" style="margin-top: 20px;" id="downloadReceipt">Download PDF Ticket</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Initialize EmailJS with your credentials
        (function() {
            emailjs.init("eUpIab2_n-wLXmMUj");
        })();

        // Initialize Supabase
        const supabaseUrl = 'https://vsxlzihjcmgkjqcpsrkc.supabase.co';
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZzeGx6aWhqY21na2pxY3BzcmtjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI1MjUzNTYsImV4cCI6MjA3ODEwMTM1Nn0.bMU5i2QBWzVB86aQAj4gjmfD1cFsFYJL877YoCqtxUk';

        // Paystack Configuration - FIXED
        const PAYSTACK_CONFIG = {
            publicKey: 'pk_live_d6b855fdc0f696978818694e852e3fc5f4a1617b',
            callbackUrl: window.location.origin,
            merchantEmail: 'ogorofelix276@gmail.com'
        };

        // M-Pesa Till Configuration
        const MPESA_TILL = '3626261';

        // EmailJS Configuration
        const EMAILJS_CONFIG = {
            serviceId: 'service_rqxvm4u',
            templateId: 'template_35nma87'
        };

        // Mobile Menu Toggle
        document.querySelector('.mobile-menu-btn').addEventListener('click', function() {
            document.querySelector('.side-nav').classList.toggle('active');
        });

        // Page Navigation
        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                
                // Get the target page
                const targetPage = this.getAttribute('data-page');
                
                // Hide all pages
                document.querySelectorAll('.page').forEach(page => {
                    page.classList.remove('active');
                });
                
                // Show target page
                document.getElementById(targetPage).classList.add('active');
                
                // Update active nav link
                document.querySelectorAll('.nav-link').forEach(navLink => {
                    navLink.classList.remove('active');
                });
                this.classList.add('active');
                
                // Close mobile menu after clicking
                if (window.innerWidth <= 768) {
                    document.querySelector('.side-nav').classList.remove('active');
                }
            });
        });

        // Update active nav link on scroll
        window.addEventListener('scroll', function() {
            const sections = document.querySelectorAll('.page');
            const navLinks = document.querySelectorAll('.nav-link');
            
            let current = '';
            
            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                const sectionHeight = section.clientHeight;
                if (scrollY >= (sectionTop - 200)) {
                    current = section.getAttribute('id');
                }
            });
            
            navLinks.forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('data-page') === current) {
                    link.classList.add('active');
                }
            });
        });

        // Countdown Timer
        function updateCountdown() {
            const eventDate = new Date('December 12, 2025 16:00:00 GMT+0300').getTime();
            const now = new Date().getTime();
            const timeLeft = eventDate - now;
            
            const days = Math.floor(timeLeft / (1000 * 60 * 60 * 24));
            const hours = Math.floor((timeLeft % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);
            
            document.getElementById('days').textContent = days.toString().padStart(2, '0');
            document.getElementById('hours').textContent = hours.toString().padStart(2, '0');
            document.getElementById('minutes').textContent = minutes.toString().padStart(2, '0');
            document.getElementById('seconds').textContent = seconds.toString().padStart(2, '0');
        }
        
        setInterval(updateCountdown, 1000);
        updateCountdown();
        
        // Ticket Selection
        document.querySelectorAll('.select-ticket').forEach(button => {
            button.addEventListener('click', function() {
                const ticketType = this.getAttribute('data-type');
                const ticketPrice = this.getAttribute('data-price');
                
                document.getElementById('ticketType').value = ticketType;
                document.getElementById('totalAmount').textContent = ticketPrice;
                
                document.getElementById('bookingForm').style.display = 'block';
                document.getElementById('paymentOptions').style.display = 'none';
                document.getElementById('bookingForm').scrollIntoView({ behavior: 'smooth' });
            });
        });
        
        // Update ticket total when quantity changes
        document.getElementById('quantity').addEventListener('change', function() {
            const ticketPrice = parseInt(document.getElementById('ticketType').value === 'Regular' ? 500 : 
                                      document.getElementById('ticketType').value === 'VIP' ? 1000 : 2000);
            const quantity = parseInt(this.value);
            const total = ticketPrice * quantity;
            
            document.getElementById('totalAmount').textContent = total;
        });
        
        // Better phone number validation
        function validatePhoneNumber(phone) {
            // Remove any spaces or special characters
            const cleanPhone = phone.replace(/\D/g, '');
            
            // Check if it starts with 254 and has 12 digits
            if (cleanPhone.startsWith('254') && cleanPhone.length === 12) {
                return cleanPhone;
            }
            
            // Check if it starts with 0 and has 10 digits (convert to 254)
            if (cleanPhone.startsWith('0') && cleanPhone.length === 10) {
                return '254' + cleanPhone.substring(1);
            }
            
            // Check if it starts with 7 and has 9 digits (add 254)
            if (cleanPhone.startsWith('7') && cleanPhone.length === 9) {
                return '254' + cleanPhone;
            }
            
            return null;
        }
        
        // Proceed to payment for tickets
        document.getElementById('proceedToPayment').addEventListener('click', function() {
            // Validate form
            const name = document.getElementById('name').value;
            const phone = document.getElementById('phone').value;
            const email = document.getElementById('email').value;
            const ticketType = document.getElementById('ticketType').value;
            const quantity = document.getElementById('quantity').value;
            
            if (!name || !phone || !email || !ticketType) {
                alert('Please fill in all required fields');
                return;
            }
            
            // Validate phone number format
            const validatedPhone = validatePhoneNumber(phone);
            if (!validatedPhone) {
                alert('Please enter a valid Kenyan phone number (e.g., 0712345678, 254712345678)');
                return;
            }
            
            // Update the phone field with validated format
            document.getElementById('phone').value = validatedPhone;
            
            document.getElementById('paymentOptions').style.display = 'block';
            document.getElementById('paymentOptions').scrollIntoView({ behavior: 'smooth' });
        });
        
        // Fixed Paystack Payment Initialization Function
        function initializePaystackPayment(config) {
            // Generate a more reliable reference
            const reference = 'MS_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
            
            const handler = PaystackPop.setup({
                key: PAYSTACK_CONFIG.publicKey,
                email: config.email,
                amount: config.amount,
                currency: 'KES',
                ref: reference,
                metadata: {
                    custom_fields: [
                        {
                            display_name: "Customer Name",
                            variable_name: "customer_name",
                            value: config.metadata.customer_name
                        },
                        {
                            display_name: "Order Type",
                            variable_name: "order_type",
                            value: config.metadata.order_type
                        },
                        {
                            display_name: "Order Reference",
                            variable_name: "order_ref",
                            value: config.metadata.order_ref
                        }
                    ]
                },
                callback: function(response) {
                    console.log('Payment callback received:', response);
                    config.callback(response);
                },
                onClose: function() {
                    console.log('Payment window closed');
                    // If payment fails, automatically show manual payment option
                    if (config.fallbackOnClose) {
                        config.fallbackOnClose();
                    } else {
                        config.onClose();
                    }
                }
            });
            
            handler.openIframe();
        }
        
        // Enhanced payment function with automatic fallback
        async function processPayment(config, orderType, orderData) {
            const statusDiv = orderType === 'ticket' ? 
                document.getElementById('paystackStatus') : 
                document.getElementById('merchPaystackStatus');
            
            try {
                statusDiv.style.display = 'block';
                statusDiv.innerHTML = '<div class="status-message status-processing">Initializing payment...</div>';
                
                // Initialize Paystack payment with automatic fallback
                initializePaystackPayment({
                    amount: config.amount,
                    email: config.email,
                    phone: config.phone,
                    metadata: config.metadata,
                    callback: function(response) {
                        statusDiv.innerHTML = '<div class="status-message status-success">Payment successful! Verifying transaction...</div>';
                        
                        // Verify payment
                        verifyPaystackPayment(response.reference, orderType, orderData);
                    },
                    onClose: function() {
                        statusDiv.innerHTML = '<div class="status-message status-error">Payment cancelled. Please try again.</div>';
                    },
                    fallbackOnClose: function() {
                        // Automatically show manual payment option when Paystack fails
                        showManualPaymentInstructions(orderType, orderData);
                    }
                });
                
            } catch (error) {
                console.error('Payment initialization error:', error);
                statusDiv.innerHTML = '<div class="status-message status-error">Payment failed: ' + error.message + '</div>';
                
                // Automatically show alternative payment options
                showAlternativePaymentOptions(orderType, orderData);
            }
        }

        // Function to show alternative payment options
        function showAlternativePaymentOptions(orderType, orderData) {
            const statusDiv = orderType === 'ticket' ? 
                document.getElementById('paystackStatus') : 
                document.getElementById('merchPaystackStatus');
            
            statusDiv.innerHTML = `
                <div class="status-message status-error">
                    <strong>M-Pesa Payment Failed</strong>
                    <p>Please try one of these alternatives:</p>
                    <div style="margin-top: 15px;">
                        <button class="btn btn-secondary" onclick="retryMpesaPayment('${orderType}', ${JSON.stringify(orderData).replace(/'/g, "\\'")})" style="margin: 5px;">
                            Retry M-Pesa
                        </button>
                        <button class="btn btn-secondary" onclick="showManualPaymentInstructions('${orderType}', ${JSON.stringify(orderData).replace(/'/g, "\\'")})" style="margin: 5px;">
                            Manual M-Pesa Payment
                        </button>
                    </div>
                </div>
            `;
        }

        // Function to show manual payment instructions
        function showManualPaymentInstructions(orderType, orderData) {
            const statusDiv = orderType === 'ticket' ? 
                document.getElementById('paystackStatus') : 
                document.getElementById('merchPaystackStatus');
            
            statusDiv.innerHTML = `
                <div class="payment-instructions">
                    <h4>Manual M-Pesa Payment Instructions:</h4>
                    <ol>
                        <li>Go to your M-Pesa menu</li>
                        <li>Select "Lipa Na M-Pesa"</li>
                        <li>Select "Buy Goods and Services"</li>
                        <li>Enter Till Number: <strong>${MPESA_TILL}</strong></li>
                        <li>Enter Amount: <strong>KSH ${orderData.total}</strong></li>
                        <li>Enter your M-Pesa PIN</li>
                        <li>Enter Account Number: <strong>${orderData.orderRef}</strong></li>
                        <li>Click "Confirm Payment" below after completing the transaction</li>
                    </ol>
                    <button class="btn btn-primary" onclick="confirmManualPayment('${orderType}', ${JSON.stringify(orderData).replace(/'/g, "\\'")})">
                        I've Completed the Payment
                    </button>
                </div>
            `;
        }

        // Function to confirm manual payment
        async function confirmManualPayment(orderType, orderData) {
            const statusDiv = orderType === 'ticket' ? 
                document.getElementById('paystackStatus') : 
                document.getElementById('merchPaystackStatus');
            
            statusDiv.innerHTML = '<div class="status-message status-processing">Verifying manual payment...</div>';
            
            // Save order as manual payment
            try {
                let orderRef;
                if (orderType === 'ticket') {
                    orderRef = await saveTicketOrder(
                        orderData.name,
                        orderData.phone,
                        orderData.email,
                        orderData.ticketType,
                        orderData.quantity,
                        orderData.total,
                        'manual_mpesa_till',
                        null
                    );
                } else if (orderType === 'merch') {
                    orderRef = await saveMerchOrder(
                        orderData.item,
                        orderData.color,
                        orderData.size,
                        orderData.quantity,
                        orderData.name,
                        orderData.phone,
                        orderData.delivery,
                        orderData.address,
                        orderData.total,
                        'manual_mpesa_till',
                        null
                    );
                }
                
                statusDiv.innerHTML = '<div class="status-message status-success">Manual payment recorded! Generating receipt...</div>';
                
                // Show success modal
                setTimeout(() => {
                    document.getElementById('modalTitle').textContent = 'Payment Recorded!';
                    document.getElementById('modalMessage').textContent = 'Your manual payment has been recorded. Please bring your M-Pesa confirmation to the event.';
                    document.getElementById('orderRefDisplay').textContent = orderRef;
                    document.getElementById('successModal').classList.add('active');
                    
                    // Store order details for receipt
                    window.currentOrder = {
                        ...orderData,
                        type: orderType,
                        orderRef: orderRef
                    };
                    
                    // Generate and download PDF ticket automatically
                    generateAndDownloadPDFTicket(window.currentOrder);
                    
                    // Send email with ticket
                    sendTicketEmail(window.currentOrder);
                }, 2000);
                
            } catch (error) {
                statusDiv.innerHTML = '<div class="status-message status-error">Error recording payment: ' + error.message + '</div>';
            }
        }
        
        // Updated Paystack Payment for Tickets
        document.getElementById('paystackPayment').addEventListener('click', function() {
            // Get form data
            const name = document.getElementById('name').value;
            const phone = document.getElementById('phone').value;
            const email = document.getElementById('email').value;
            const ticketType = document.getElementById('ticketType').value;
            const quantity = document.getElementById('quantity').value;
            const total = parseInt(document.getElementById('totalAmount').textContent);
            
            // Generate order reference
            const orderRef = 'MS-' + Date.now().toString().slice(-6) + '-' + Math.random().toString(36).substring(2, 5).toUpperCase();
            
            const orderData = {
                name: name,
                phone: phone,
                email: email,
                ticketType: ticketType,
                quantity: quantity,
                total: total,
                orderRef: orderRef
            };
            
            processPayment({
                amount: total * 100,
                email: email,
                phone: phone,
                metadata: {
                    customer_name: name,
                    ticket_type: ticketType,
                    quantity: parseInt(quantity),
                    order_ref: orderRef,
                    order_type: 'ticket'
                }
            }, 'ticket', orderData);
        });
        
        // Verify Paystack Payment
        async function verifyPaystackPayment(reference, orderType, orderData) {
            try {
                const statusDiv = orderType === 'ticket' ? 
                    document.getElementById('paystackStatus') : 
                    document.getElementById('merchPaystackStatus');
                
                statusDiv.innerHTML = '<div class="status-message status-processing">Verifying payment with Paystack...</div>';
                
                // Simulate API call to verify payment
                setTimeout(async () => {
                    try {
                        // Save order to database
                        if (orderType === 'ticket') {
                            await saveTicketOrder(
                                orderData.name,
                                orderData.phone,
                                orderData.email,
                                orderData.ticketType,
                                orderData.quantity,
                                orderData.total,
                                'paystack',
                                reference
                            );
                        } else if (orderType === 'merch') {
                            await saveMerchOrder(
                                orderData.item,
                                orderData.color,
                                orderData.size,
                                orderData.quantity,
                                orderData.name,
                                orderData.phone,
                                orderData.delivery,
                                orderData.address,
                                orderData.total,
                                'paystack',
                                reference
                            );
                        } else if (orderType === 'donation') {
                            await saveDonation(
                                orderData.name,
                                orderData.phone,
                                orderData.email,
                                orderData.amount,
                                orderData.message
                            );
                        }
                        
                        statusDiv.innerHTML = '<div class="status-message status-success">Payment verified successfully! Generating receipt...</div>';
                        
                        // Show success modal
                        setTimeout(() => {
                            document.getElementById('modalTitle').textContent = 'Payment Successful!';
                            document.getElementById('modalMessage').textContent = orderType === 'ticket' ? 
                                'Your ticket has been successfully booked.' : 
                                'Your order has been successfully placed.';
                            document.getElementById('orderRefDisplay').textContent = orderData.orderRef;
                            document.getElementById('successModal').classList.add('active');
                            
                            // Store order details for receipt
                            window.currentOrder = {
                                ...orderData,
                                type: orderType,
                                paystackReference: reference
                            };
                            
                            // Generate and download PDF ticket automatically for ticket purchases
                            if (orderType === 'ticket') {
                                generateAndDownloadPDFTicket(window.currentOrder);
                                // Send email with ticket
                                sendTicketEmail(window.currentOrder);
                            }
                        }, 2000);
                        
                    } catch (error) {
                        statusDiv.innerHTML = '<div class="status-message status-error">Error saving order: ' + error.message + '</div>';
                    }
                }, 3000);
                
            } catch (error) {
                console.error('Payment verification error:', error);
                const statusDiv = orderType === 'ticket' ? 
                    document.getElementById('paystackStatus') : 
                    document.getElementById('merchPaystackStatus');
                statusDiv.innerHTML = '<div class="status-message status-error">Payment verification failed. Please contact support.</div>';
            }
        }
        
        // Function to save ticket order to database
        async function saveTicketOrder(name, phone, email, ticketType, quantity, total, paymentMethod, reference = null) {
            const orderRef = 'MS-' + Date.now().toString().slice(-6) + '-' + Math.random().toString(36).substring(2, 5).toUpperCase();
            
            const { data, error } = await supabase
                .from('ticket_orders')
                .insert([
                    {
                        order_ref: orderRef,
                        customer_name: name,
                        customer_phone: phone,
                        customer_email: email,
                        ticket_type: ticketType,
                        quantity: parseInt(quantity),
                        total_amount: parseInt(total),
                        payment_method: paymentMethod,
                        paystack_reference: reference,
                        status: 'confirmed',
                        created_at: new Date()
                    }
                ]);
            
            if (error) {
                throw new Error(error.message);
            }
            
            return orderRef;
        }
        
        // Function to send ticket email using EmailJS
        async function sendTicketEmail(order) {
            try {
                // Generate HTML content for the email
                const emailContent = generateEmailHTML(order);
                
                // Prepare email parameters
                const templateParams = {
                    to_name: order.name,
                    to_email: order.email,
                    order_reference: order.orderRef,
                    ticket_type: order.ticketType,
                    quantity: order.quantity,
                    total_amount: `KSH ${order.total}`,
                    event_name: 'Man Sango at 6 Live Concert',
                    event_date: 'December 12, 2025',
                    event_time: '4:00 PM',
                    event_venue: 'Echo Lounge, MKO Plaza, Daraja Mbili, Kisii',
                    customer_phone: order.phone,
                    email_content: emailContent
                };

                // Send email using EmailJS
                const response = await emailjs.send(
                    EMAILJS_CONFIG.serviceId,
                    EMAILJS_CONFIG.templateId,
                    templateParams
                );

                console.log('Email sent successfully:', response);
                return true;
            } catch (error) {
                console.error('Failed to send email:', error);
                return false;
            }
        }

        // Function to generate HTML content for email
        function generateEmailHTML(order) {
            return `
                <!DOCTYPE html>
                <html>
                <head>
                    <style>
                        body { 
                            font-family: 'Poppins', Arial, sans-serif; 
                            margin: 0; 
                            padding: 20px; 
                            background: #f8fafc;
                        }
                        .ticket-container {
                            max-width: 500px;
                            margin: 0 auto;
                            background: linear-gradient(135deg, #2563eb, #1d4ed8);
                            color: white;
                            padding: 20px;
                            border-radius: 12px;
                            position: relative;
                        }
                        .event-image {
                            width: 100%;
                            height: 120px;
                            object-fit: cover;
                            border-radius: 8px;
                            margin-bottom: 15px;
                        }
                        .artist-image {
                            width: 80px;
                            height: 80px;
                            border-radius: 50%;
                            object-fit: cover;
                            border: 3px solid white;
                            margin: 0 auto 15px;
                            display: block;
                        }
                        .ticket-header {
                            text-align: center;
                            margin-bottom: 20px;
                        }
                        .ticket-header h1 {
                            margin: 0;
                            font-size: 24px;
                            font-weight: bold;
                        }
                        .ticket-header p {
                            margin: 5px 0;
                            opacity: 0.9;
                        }
                        .ticket-details {
                            background: rgba(255, 255, 255, 0.1);
                            padding: 15px;
                            border-radius: 8px;
                            margin-bottom: 15px;
                        }
                        .detail-row {
                            display: flex;
                            justify-content: space-between;
                            margin-bottom: 8px;
                            padding: 5px 0;
                            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
                        }
                        .detail-row:last-child {
                            border-bottom: none;
                            margin-bottom: 0;
                        }
                        .detail-label {
                            font-weight: 600;
                        }
                        .qr-code {
                            text-align: center;
                            margin: 20px 0;
                            padding: 15px;
                            background: white;
                            border-radius: 8px;
                        }
                        .qr-placeholder {
                            width: 150px;
                            height: 150px;
                            background: #f1f5f9;
                            margin: 0 auto;
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            border-radius: 8px;
                            color: #64748b;
                            font-size: 12px;
                        }
                        .footer {
                            text-align: center;
                            margin-top: 20px;
                            font-size: 12px;
                            opacity: 0.8;
                        }
                        .instructions {
                            background: rgba(255, 255, 255, 0.1);
                            padding: 15px;
                            border-radius: 8px;
                            margin-top: 15px;
                            font-size: 12px;
                        }
                    </style>
                </head>
                <body>
                    <div class="ticket-container">
                        <div class="ticket-header">
                            <h1>MAN SANGO CONCERT TICKET</h1>
                            <p>Live at Echo Lounge Kisii</p>
                            <p>December 12, 2025 - 4:00 PM</p>
                        </div>
                        
                        <div class="ticket-details">
                            <div class="detail-row">
                                <span class="detail-label">Order Reference:</span>
                                <span>${order.orderRef}</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Ticket Type:</span>
                                <span>${order.ticketType}</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Quantity:</span>
                                <span>${order.quantity}</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Total Amount:</span>
                                <span>KSH ${order.total}</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Customer Name:</span>
                                <span>${order.name}</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Phone:</span>
                                <span>${order.phone}</span>
                            </div>
                        </div>
                        
                        <div class="qr-code">
                            <div class="qr-placeholder">
                                QR CODE<br>SCAN AT VENUE
                            </div>
                        </div>
                        
                        <div class="instructions">
                            <strong>Important Instructions:</strong><br>
                            â€¢ Present this ticket at the venue for entry<br>
                            â€¢ Bring valid ID matching the customer name<br>
                            â€¢ Doors open at 3:00 PM<br>
                            â€¢ No refunds or exchanges
                        </div>
                        
                        <div class="footer">
                            <p>Contact: 0748840501 | Email: mansangoentertainment@gmail.com</p>
                            <p>Â© 2025 Fresh Music Entertainment. All rights reserved.</p>
                        </div>
                    </div>
                </body>
                </html>
            `;
        }
        
        // Ticket Retrieval
        document.getElementById('retrieveTicket').addEventListener('click', function() {
            const bookingRef = document.getElementById('retrieveBookingRef').value;
            const phone = document.getElementById('retrievePhone').value;
            const statusDiv = document.getElementById('retrieveStatus');
            
            if (!bookingRef || !phone) {
                alert('Please enter both booking reference and phone number');
                return;
            }
            
            statusDiv.style.display = 'block';
            statusDiv.innerHTML = '<div class="status-message status-processing">Retrieving your ticket... Please wait</div>';
            
            // Retrieve from database
            retrieveTicket(bookingRef, phone)
                .then(ticket => {
                    statusDiv.innerHTML = '<div class="status-message status-success">Ticket found! Downloading your ticket...</div>';
                    
                    // Show ticket details and download option
                    setTimeout(() => {
                        document.getElementById('modalTitle').textContent = 'Ticket Retrieved!';
                        document.getElementById('modalMessage').textContent = 'Your ticket has been successfully retrieved.';
                        document.getElementById('orderRefDisplay').textContent = ticket.order_ref;
                        document.getElementById('successModal').classList.add('active');
                        
                        // Store order details for receipt
                        window.currentOrder = {
                            name: ticket.customer_name,
                            phone: ticket.customer_phone,
                            email: ticket.customer_email,
                            ticketType: ticket.ticket_type,
                            quantity: ticket.quantity,
                            total: ticket.total_amount,
                            orderRef: ticket.order_ref,
                            type: 'ticket'
                        };
                        
                        // Generate and download PDF ticket automatically
                        generateAndDownloadPDFTicket(window.currentOrder);
                    }, 2000);
                })
                .catch(error => {
                    statusDiv.innerHTML = '<div class="status-message status-error">Error retrieving ticket: ' + error.message + '</div>';
                });
        });
        
        // Function to retrieve ticket from database
        async function retrieveTicket(bookingRef, phone) {
            const { data, error } = await supabase
                .from('ticket_orders')
                .select('*')
                .eq('order_ref', bookingRef)
                .eq('customer_phone', phone)
                .single();
            
            if (error) {
                throw new Error('Ticket not found. Please check your booking reference and phone number.');
            }
            
            return data;
        }
        
        // Merchandise Purchase
        document.querySelectorAll('.buy-merch').forEach(button => {
            button.addEventListener('click', function() {
                const item = this.getAttribute('data-item');
                const price = this.getAttribute('data-price');
                
                document.getElementById('merchItem').value = item;
                document.getElementById('merchTotalAmount').textContent = price;
                
                // Set color options based on item
                const colorOptions = document.getElementById('colorOptions');
                colorOptions.innerHTML = '';
                
                let colors = [];
                if (item === 'T-Shirt') {
                    colors = [
                        { name: 'Black', value: '#000000' },
                        { name: 'White', value: '#FFFFFF' },
                        { name: 'Navy Blue', value: '#000080' },
                        { name: 'Red', value: '#FF0000' },
                        { name: 'Gray', value: '#808080' }
                    ];
                } else if (item === 'Hoodie') {
                    colors = [
                        { name: 'Black', value: '#000000' },
                        { name: 'Charcoal', value: '#36454F' },
                        { name: 'Navy Blue', value: '#000080' },
                        { name: 'Burgundy', value: '#800020' },
                        { name: 'Forest Green', value: '#228B22' }
                    ];
                }
                
                colors.forEach(color => {
                    const colorOption = document.createElement('div');
                    colorOption.className = 'color-option';
                    colorOption.style.backgroundColor = color.value;
                    colorOption.setAttribute('data-color', color.name);
                    colorOption.setAttribute('title', color.name);
                    
                    colorOption.addEventListener('click', function() {
                        document.querySelectorAll('.color-option').forEach(opt => {
                            opt.classList.remove('selected');
                        });
                        this.classList.add('selected');
                    });
                    
                    colorOptions.appendChild(colorOption);
                });
                
                // Select first color by default
                if (colorOptions.firstChild) {
                    colorOptions.firstChild.classList.add('selected');
                }
                
                document.getElementById('merchForm').style.display = 'block';
                document.getElementById('merchPaymentOptions').style.display = 'none';
                document.getElementById('merchForm').scrollIntoView({ behavior: 'smooth' });
            });
        });
        
        // Show/hide delivery address based on delivery option
        document.getElementById('deliveryOption').addEventListener('change', function() {
            const deliveryAddressGroup = document.getElementById('deliveryAddressGroup');
            if (this.value === 'delivery') {
                deliveryAddressGroup.style.display = 'block';
            } else {
                deliveryAddressGroup.style.display = 'none';
            }
            updateMerchTotal();
        });
        
        // Update merch total
        document.getElementById('merchQuantity').addEventListener('change', updateMerchTotal);
        
        function updateMerchTotal() {
            const basePrice = parseInt(document.getElementById('merchItem').value === 'T-Shirt' ? 1500 : 3000);
            const quantity = parseInt(document.getElementById('merchQuantity').value);
            const deliveryOption = document.getElementById('deliveryOption').value;
            const deliveryCost = deliveryOption === 'delivery' ? 200 : 0;
            
            const total = (basePrice * quantity) + deliveryCost;
            document.getElementById('merchTotalAmount').textContent = total;
        }
        
        // Proceed to merch payment
        document.getElementById('proceedToMerchPayment').addEventListener('click', function() {
            // Validate form
            const item = document.getElementById('merchItem').value;
            const selectedColor = document.querySelector('.color-option.selected');
            const size = document.getElementById('merchSize').value;
            const quantity = document.getElementById('merchQuantity').value;
            const name = document.getElementById('customerName').value;
            const phone = document.getElementById('customerPhone').value;
            const email = document.getElementById('customerEmail').value;
            const deliveryOption = document.getElementById('deliveryOption').value;
            const deliveryAddress = document.getElementById('deliveryAddress').value;
            
            if (!item) {
                alert('Please select a merchandise item');
                return;
            }
            
            if (!selectedColor) {
                alert('Please select a color');
                return;
            }
            
            if (!name || !phone || !email) {
                alert('Please fill in all required fields');
                return;
            }
            
            if (deliveryOption === 'delivery' && !deliveryAddress) {
                alert('Please enter your delivery address');
                return;
            }
            
            // Validate phone number format
            const validatedPhone = validatePhoneNumber(phone);
            if (!validatedPhone) {
                alert('Please enter a valid Kenyan phone number (e.g., 0712345678, 254712345678)');
                return;
            }
            
            // Update the phone field with validated format
            document.getElementById('customerPhone').value = validatedPhone;
            
            document.getElementById('merchPaymentOptions').style.display = 'block';
            document.getElementById('merchPaymentOptions').scrollIntoView({ behavior: 'smooth' });
        });
        
        // Merchandise Paystack Payment
        document.getElementById('merchPaystackPayment').addEventListener('click', function() {
            // Get form data
            const item = document.getElementById('merchItem').value;
            const selectedColor = document.querySelector('.color-option.selected');
            const size = document.getElementById('merchSize').value;
            const quantity = document.getElementById('merchQuantity').value;
            const name = document.getElementById('customerName').value;
            const phone = document.getElementById('customerPhone').value;
            const email = document.getElementById('customerEmail').value;
            const deliveryOption = document.getElementById('deliveryOption').value;
            const deliveryAddress = document.getElementById('deliveryAddress').value;
            const total = parseInt(document.getElementById('merchTotalAmount').textContent);
            
            // Generate order reference
            const orderRef = 'MS-MERCH-' + Date.now().toString().slice(-6) + '-' + Math.random().toString(36).substring(2, 5).toUpperCase();
            
            const orderData = {
                item: item,
                color: selectedColor ? selectedColor.getAttribute('data-color') : 'Not selected',
                size: size,
                quantity: quantity,
                name: name,
                phone: phone,
                email: email,
                delivery: deliveryOption,
                address: deliveryAddress,
                total: total,
                orderRef: orderRef
            };
            
            processPayment({
                amount: total * 100,
                email: email,
                phone: phone,
                metadata: {
                    customer_name: name,
                    item: item,
                    color: selectedColor ? selectedColor.getAttribute('data-color') : 'Not selected',
                    size: size,
                    quantity: parseInt(quantity),
                    delivery_option: deliveryOption,
                    delivery_address: deliveryAddress,
                    order_ref: orderRef,
                    order_type: 'merchandise'
                }
            }, 'merch', orderData);
        });
        
        // Function to save merch order to database
        async function saveMerchOrder(item, color, size, quantity, name, phone, deliveryOption, deliveryAddress, total, paymentMethod, reference = null) {
            const orderRef = 'MS-MERCH-' + Date.now().toString().slice(-6) + '-' + Math.random().toString(36).substring(2, 5).toUpperCase();
            
            const { data, error } = await supabase
                .from('merch_orders')
                .insert([
                    {
                        order_ref: orderRef,
                        item: item,
                        color: color,
                        size: size,
                        quantity: parseInt(quantity),
                        customer_name: name,
                        customer_phone: phone,
                        delivery_option: deliveryOption,
                        delivery_address: deliveryAddress,
                        total_amount: parseInt(total),
                        payment_method: paymentMethod,
                        paystack_reference: reference,
                        status: 'confirmed',
                        created_at: new Date()
                    }
                ]);
            
            if (error) {
                throw new Error(error.message);
            }
            
            return orderRef;
        }
        
        // Modal Close
        document.getElementById('closeModal').addEventListener('click', function() {
            document.getElementById('successModal').classList.remove('active');
        });
        
        // Download Receipt
        document.getElementById('downloadReceipt').addEventListener('click', function() {
            if (window.currentOrder && window.currentOrder.type === 'ticket') {
                generateAndDownloadPDFTicket(window.currentOrder);
            } else {
                downloadReceipt();
            }
        });
        
        // Function to generate and download PDF ticket
        function generateAndDownloadPDFTicket(order) {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            // Add background color
            doc.setFillColor(26, 75, 140); // Primary color
            doc.rect(0, 0, 210, 50, 'F');
            
            // Add header
            doc.setFontSize(20);
            doc.setTextColor(255, 255, 255);
            doc.text('MAN SANGO CONCERT TICKET', 105, 20, { align: 'center' });
            
            doc.setFontSize(14);
            doc.text('Live at Echo Lounge Kisii', 105, 30, { align: 'center' });
            
            // Add ticket details
            doc.setFillColor(255, 255, 255);
            doc.rect(10, 60, 190, 120, 'F');
            
            doc.setFontSize(16);
            doc.setTextColor(26, 75, 140);
            doc.text('TICKET DETAILS', 20, 75);
            
            doc.setFontSize(12);
            doc.setTextColor(0, 0, 0);
            doc.text(`Order Reference: ${order.orderRef}`, 20, 90);
            doc.text(`Ticket Type: ${order.ticketType}`, 20, 100);
            doc.text(`Quantity: ${order.quantity}`, 20, 110);
            doc.text(`Total Amount: KSH ${order.total}`, 20, 120);
            
            // Add customer details
            doc.text('CUSTOMER DETAILS', 20, 140);
            doc.text(`Name: ${order.name}`, 20, 150);
            doc.text(`Phone: ${order.phone}`, 20, 160);
            doc.text(`Email: ${order.email}`, 20, 170);
            
            // Add event details
            doc.text('EVENT DETAILS', 120, 75);
            doc.text('Man Sango at 6 Live Concert', 120, 90);
            doc.text('Date: December 12, 2025', 120, 100);
            doc.text('Time: 4:00 PM', 120, 110);
            doc.text('Venue: Echo Lounge Kisii', 120, 120);
            doc.text('Location: MKO Plaza, Daraja Mbili', 120, 130);
            
            // Add QR code placeholder
            doc.setFontSize(10);
            doc.setTextColor(100, 100, 100);
            doc.text('Present this ticket at the venue for entry', 105, 190, { align: 'center' });
            
            // Add footer
            doc.setFontSize(8);
            doc.text('Contact: 0748840501 | Email: mansangoentertainment@gmail.com', 105, 280, { align: 'center' });
            doc.text('Â© 2025 Fresh Music Entertainment. All rights reserved.', 105, 285, { align: 'center' });
            
            // Download the PDF
            doc.save(`ManSango_Ticket_${order.orderRef}.pdf`);
        }
        
        // Function to download receipt
        function downloadReceipt() {
            if (!window.currentOrder) {
                alert('No order information found');
                return;
            }
            
            const order = window.currentOrder;
            
            // Create receipt content based on order type
            let receiptContent = '';
            
            if (order.type === 'ticket') {
                receiptContent = `
                    MAN SANGO CONCERT TICKET RECEIPT
                    Order Reference: ${order.orderRef}
                    Date: ${new Date().toLocaleDateString()}
                    Time: ${new Date().toLocaleTimeString()}
                    
                    TICKET DETAILS:
                    Ticket Type: ${order.ticketType}
                    Quantity: ${order.quantity}
                    Unit Price: KSH ${order.ticketType === 'Regular' ? '500' : order.ticketType === 'VIP' ? '1000' : '2000'}
                    
                    CUSTOMER DETAILS:
                    Name: ${order.name}
                    Phone: ${order.phone}
                    Email: ${order.email}
                    
                    PAYMENT DETAILS:
                    Total: KSH ${order.total}
                    Payment Method: ${order.paystackReference ? 'Paystack (M-Pesa)' : 'Manual M-Pesa Till'}
                    ${order.paystackReference ? `Paystack Reference: ${order.paystackReference}` : `M-Pesa Till: ${MPESA_TILL}`}
                    
                    Thank you for your purchase!
                    Present this receipt at the venue for entry.
                    
                    ---
                    Contact Details:
                    Phone: 0748840501
                    Email: mansangoentertainment@gmail.com
                    Venue: Echo Lounge, MKO Plaza, Daraja Mbili, Kisii
                `;
            } else if (order.type === 'merch') {
                receiptContent = `
                    MAN SANGO MERCHANDISE RECEIPT
                    Order Reference: ${order.orderRef}
                    Date: ${new Date().toLocaleDateString()}
                    Time: ${new Date().toLocaleTimeString()}
                    
                    ITEM DETAILS:
                    Product: ${order.item}
                    Color: ${order.color}
                    Size: ${order.size}
                    Quantity: ${order.quantity}
                    Unit Price: KSH ${order.item === 'T-Shirt' ? '1500' : '3000'}
                    
                    CUSTOMER DETAILS:
                    Name: ${order.name}
                    Phone: ${order.phone}
                    Email: ${order.email}
                    Delivery: ${order.delivery === 'event' ? 'Collect at Event' : 'Home Delivery'}
                    ${order.delivery === 'delivery' ? `Address: ${order.address}` : ''}
                    
                    PAYMENT DETAILS:
                    Subtotal: KSH ${order.item === 'T-Shirt' ? 1500 * order.quantity : 3000 * order.quantity}
                    ${order.delivery === 'delivery' ? 'Delivery Fee: KSH 200' : 'Delivery Fee: KSH 0'}
                    Total: KSH ${order.total}
                    Payment Method: ${order.paystackReference ? 'Paystack (M-Pesa)' : 'Manual M-Pesa Till'}
                    ${order.paystackReference ? `Paystack Reference: ${order.paystackReference}` : `M-Pesa Till: ${MPESA_TILL}`}
                    
                    Thank you for your purchase!
                    Your order will be ready for ${order.delivery === 'event' ? 'collection at the event' : 'delivery within 5 days'}.
                    
                    ---
                    Contact Details:
                    Phone: 0748840501
                    Email: mansangoentertainment@gmail.com
                    Venue: Echo Lounge, MKO Plaza, Daraja Mbili, Kisii
                `;
            } else if (order.type === 'donation') {
                receiptContent = `
                    MAN SANGO DONATION RECEIPT
                    Date: ${new Date().toLocaleDateString()}
                    Time: ${new Date().toLocaleTimeString()}
                    
                    DONOR DETAILS:
                    Name: ${order.name}
                    Phone: ${order.phone}
                    Email: ${order.email}
                    ${order.message ? `Message: ${order.message}` : ''}
                    
                    DONATION DETAILS:
                    Amount: KSH ${order.amount}
                    Payment Method: Paystack (M-Pesa)
                    ${order.paystackReference ? `Paystack Reference: ${order.paystackReference}` : ''}
                    
                    Thank you for your generous donation!
                    Your support helps create more amazing music and events.
                    
                    ---
                    Contact Details:
                    Phone: 0748840501
                    Email: mansangoentertainment@gmail.com
                `;
            }
            
            // Create a blob with the receipt content
            const blob = new Blob([receiptContent], { type: 'text/plain' });
            
            // Create a download link
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `ManSango_Receipt_${order.orderRef || 'DONATION'}.txt`;
            
            // Trigger the download
            document.body.appendChild(a);
            a.click();
            
            // Clean up
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            alert('Receipt downloaded successfully!');
        }
        
        // Donation functionality
        document.querySelectorAll('.donation-option').forEach(option => {
            option.addEventListener('click', function() {
                document.querySelectorAll('.donation-option').forEach(opt => {
                    opt.classList.remove('active');
                });
                this.classList.add('active');
                document.getElementById('customAmount').value = '';
            });
        });
        
        document.getElementById('customAmount').addEventListener('input', function() {
            if (this.value) {
                document.querySelectorAll('.donation-option').forEach(opt => {
                    opt.classList.remove('active');
                });
            }
        });
        
        document.getElementById('donateNow').addEventListener('click', function() {
            const name = document.getElementById('donorName').value;
            const phone = document.getElementById('donorPhone').value;
            const email = document.getElementById('donorEmail').value;
            const message = document.getElementById('donorMessage').value;
            
            // Get donation amount
            let amount = 0;
            const selectedOption = document.querySelector('.donation-option.active');
            if (selectedOption) {
                amount = parseInt(selectedOption.getAttribute('data-amount'));
            } else if (document.getElementById('customAmount').value) {
                amount = parseInt(document.getElementById('customAmount').value);
            }
            
            if (!name || !phone || !email || amount <= 0) {
                alert('Please fill in all required fields and select a donation amount');
                return;
            }
            
            // Validate phone number format
            const validatedPhone = validatePhoneNumber(phone);
            if (!validatedPhone) {
                alert('Please enter a valid Kenyan phone number (e.g., 0712345678, 254712345678)');
                return;
            }
            
            // Update the phone field with validated format
            document.getElementById('donorPhone').value = validatedPhone;
            
            const statusDiv = document.getElementById('donationStatus');
            statusDiv.style.display = 'block';
            statusDiv.innerHTML = '<div class="status-message status-processing">Initializing Paystack payment...</div>';
            
            // Generate order reference
            const orderRef = 'MS-DONATION-' + Date.now().toString().slice(-6) + '-' + Math.random().toString(36).substring(2, 5).toUpperCase();
            
            // Initialize Paystack payment
            initializePaystackPayment({
                amount: amount * 100, // Convert to kobo
                email: email,
                phone: validatedPhone,
                metadata: {
                    customer_name: name,
                    donation_amount: amount,
                    message: message,
                    order_ref: orderRef,
                    order_type: 'donation'
                },
                callback: function(response) {
                    // Payment successful
                    statusDiv.innerHTML = '<div class="status-message status-success">Payment successful! Verifying transaction...</div>';
                    
                    // Verify payment and save to database
                    verifyPaystackPayment(response.reference, 'donation', {
                        name: name,
                        phone: validatedPhone,
                        email: email,
                        amount: amount,
                        message: message,
                        orderRef: orderRef
                    });
                },
                onClose: function() {
                    statusDiv.innerHTML = '<div class="status-message status-error">Payment window closed. Please try again.</div>';
                }
            });
        });
        
        // Function to save donation to database
        async function saveDonation(name, phone, email, amount, message) {
            const { data, error } = await supabase
                .from('donations')
                .insert([
                    {
                        donor_name: name,
                        donor_phone: phone,
                        donor_email: email,
                        amount: parseInt(amount),
                        message: message,
                        created_at: new Date()
                    }
                ]);
            
            if (error) {
                throw new Error(error.message);
            }
            
            return data;
        }
        
        // Fade in elements on scroll
        const fadeElements = document.querySelectorAll('.fade-in');
        
        const fadeInOnScroll = () => {
            fadeElements.forEach(element => {
                const elementTop = element.getBoundingClientRect().top;
                const elementVisible = 150;
                
                if (elementTop < window.innerHeight - elementVisible) {
                    element.classList.add('active');
                }
            });
        };
        
        window.addEventListener('scroll', fadeInOnScroll);
        fadeInOnScroll(); // Initial check
    </script>
</body>
</html>
